<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Galeri Media Premium - Semua Jenis File</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --primary-color: #2563eb;
      --secondary-color: #4f46e5;
      --accent-color: #f59e0b;
      --danger-color: #ef4444;
      --success-color: #10b981;
      --dark-bg: #0f172a;
      --dark-card: #1e293b;
      --dark-border: #334155;
      --light-bg: #f8fafc;
      --light-card: #ffffff;
      --light-border: #e2e8f0;
      --text-primary: #1e293b;
      --text-secondary: #64748b;
      --text-light: #94a3b8;
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      --radius: 0.75rem;
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --navbar-height: 80px; /* Tinggi navbar yang diperhitungkan */
    }

    body.dark {
      --bg-color: var(--dark-bg);
      --card-bg: var(--dark-card);
      --border-color: --dark-border;
      --text-color: #f1f5f9;
      --text-secondary: #cbd5e1;
      --text-light: #94a3b8;
    }

    body:not(.dark) {
      --bg-color: var(--light-bg);
      --card-bg: var(--light-card);
      --border-color: var(--light-border);
      --text-color: var(--text-primary);
      --text-secondary: var(--text-secondary);
      --text-light: var(--text-light);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      transition: var(--transition);
      padding-top: var(--navbar-height); /* Menggunakan variabel untuk padding top */
      min-height: 100vh;
    }

    /* Navbar Styles */
    .navbar {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      box-shadow: var(--shadow-md);
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 1000;
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      height: var(--navbar-height); /* Tinggi navbar yang ditetapkan */
    }

    .navbar-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0.75rem 1rem;
      height: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .navbar-brand {
      font-weight: 700;
      font-size: 1.5rem;
      color: white !important;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .navbar-controls {
      display: flex;
      align-items: center;
      gap: 0.5rem; /* Mengurangi gap antar kontrol */
      flex-wrap: wrap;
    }

    .form-control, .form-select {
      border-radius: var(--radius);
      border: 1px solid var(--border-color);
      background-color: var(--card-bg);
      color: var(--text-color);
      padding: 0.5rem 0.75rem; /* Mengurangi padding horizontal */
      font-weight: 500;
      transition: var(--transition);
      box-shadow: var(--shadow-sm);
      width: 120px; /* Mengatur lebar tetap untuk semua kontrol */
      font-size: 0.875rem; /* Mengurangi ukuran font */
    }

    .form-control:focus, .form-select:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
      outline: none;
    }

    /* Theme Toggle */
    .theme-toggle {
      position: relative;
      width: 50px; /* Mengurangi ukuran toggle */
      height: 25px; /* Mengurangi ukuran toggle */
      background-color: rgba(255, 255, 255, 0.2);
      border-radius: 25px;
      cursor: pointer;
      transition: var(--transition);
    }

    .theme-toggle-slider {
      position: absolute;
      top: 2.5px; /* Menyesuaikan posisi */
      left: 2.5px; /* Menyesuaikan posisi */
      width: 20px; /* Mengurangi ukuran slider */
      height: 20px; /* Mengurangi ukuran slider */
      background-color: white;
      border-radius: 50%;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    body.dark .theme-toggle-slider {
      transform: translateX(25px); /* Menyesuaikan posisi */
    }

    /* Main Content */
    .container-fluid {
      padding: 2rem;
      max-width: 1400px;
      margin: 0 auto;
    }

    .section-title {
      font-weight: 700;
      font-size: 1.75rem;
      margin-bottom: 1.5rem;
      color: var(--text-color);
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .section-title i {
      color: var(--primary-color);
    }

    /* Filter Section */
    .filter-section {
      background-color: var(--card-bg);
      border-radius: var(--radius);
      padding: 1.5rem;
      margin-bottom: 2rem;
      box-shadow: var(--shadow-md);
      border: 1px solid var(--border-color);
    }

    .filter-title {
      font-weight: 600;
      margin-bottom: 1rem;
      color: var(--text-color);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .filter-controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .filter-group label {
      font-weight: 500;
      font-size: 0.875rem;
      color: var(--text-secondary);
    }

    /* Stats Section */
    .stats-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .stat-card {
      background: linear-gradient(135deg, var(--card-bg), rgba(255, 255, 255, 0.05));
      border-radius: var(--radius);
      padding: 1.5rem;
      box-shadow: var(--shadow-md);
      border: 1px solid var(--border-color);
      transition: var(--transition);
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-lg);
    }

    .stat-icon {
      font-size: 2rem;
      margin-bottom: 0.75rem;
      color: var(--primary-color);
    }

    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--text-color);
      margin-bottom: 0.25rem;
    }

    .stat-label {
      font-size: 0.875rem;
      color: var(--text-secondary);
      font-weight: 500;
    }

    /* Media Grid */
    .media-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .media-card {
      background-color: var(--card-bg);
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: var(--shadow-md);
      border: 1px solid var(--border-color);
      transition: var(--transition);
      position: relative;
    }

    .media-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-xl);
    }

    .media-preview {
      position: relative;
      height: 200px;
      overflow: hidden;
      background-color: var(--dark-bg);
      cursor: pointer;
    }

    .media-preview img,
    .media-preview video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: var(--transition);
    }

    .media-card:hover .media-preview img,
    .media-card:hover .media-preview video {
      transform: scale(1.05);
    }

    .file-preview {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, rgba(37, 99, 235, 0.1), rgba(79, 70, 229, 0.1));
      color: var(--primary-color);
      padding: 1rem;
      transition: var(--transition);
    }

    .file-preview:hover {
      background: linear-gradient(135deg, rgba(37, 99, 235, 0.2), rgba(79, 70, 229, 0.2));
    }

    .file-icon {
      font-size: 3rem;
      margin-bottom: 0.5rem;
    }

    .file-info {
      font-size: 0.875rem;
      font-weight: 500;
      text-align: center;
    }

    .file-name-overlay {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 0.5rem;
      font-size: 0.875rem;
      font-weight: 500;
      text-align: center;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .file-ext {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background-color: var(--primary-color);
      color: white;
      font-size: 0.75rem;
      font-weight: 600;
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      text-transform: uppercase;
      z-index: 10;
      box-shadow: var(--shadow-md);
    }

    /* Warna untuk berbagai jenis file */
    .ext-pdf { background-color: #ef4444 !important; }
    .ext-doc, .ext-docx { background-color: #2563eb !important; }
    .ext-xls, .ext-xlsx { background-color: #10b981 !important; }
    .ext-ppt, .ext-pptx { background-color: #f59e0b !important; }
    .ext-txt, .ext-md { background-color: #64748b !important; }
    .ext-zip, .ext-rar, .ext-7z { background-color: #8b5cf6 !important; }
    .ext-mp3, .ext-wav, .ext-flac { background-color: #06b6d4 !important; }
    .ext-exe { background-color: #f97316 !important; }
    .ext-html, .ext-htm { background-color: #f59e0b !important; }
    .ext-css { background-color: #3b82f6 !important; }
    .ext-js { background-color: #eab308 !important; }
    .ext-json { background-color: #475569 !important; }
    .ext-xml { background-color: #14b8a6 !important; }
    .ext-sql { background-color: #1e293b !important; }
    .ext-csv { background-color: #10b981 !important; }

    .media-details {
      padding: 1.25rem;
    }

    .media-title {
      font-weight: 600;
      font-size: 1rem;
      color: var(--text-color);
      margin-bottom: 0.75rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .media-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.875rem;
      color: var(--text-secondary);
      margin-bottom: 0.75rem;
    }

    .media-path {
      font-size: 0.75rem;
      color: var(--text-light);
      margin-bottom: 0.75rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .media-actions {
      display: flex;
      gap: 0.5rem;
    }

    .btn-action {
      flex: 1;
      padding: 0.5rem;
      border-radius: calc(var(--radius) / 2);
      border: none;
      font-size: 0.875rem;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.25rem;
    }

    .btn-view {
      background-color: rgba(37, 99, 235, 0.1);
      color: var(--primary-color);
    }

    .btn-view:hover {
      background-color: var(--primary-color);
      color: white;
    }

    .btn-copy {
      background-color: rgba(16, 185, 129, 0.1);
      color: var(--success-color);
    }

    .btn-copy:hover {
      background-color: var(--success-color);
      color: white;
    }

    /* Pagination */
    .pagination-container {
      display: flex;
      justify-content: center;
      margin: 2rem 0;
    }

    .pagination {
      display: flex;
      gap: 0.5rem;
    }

    .page-item {
      list-style: none;
    }

    .page-link {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 2.5rem;
      height: 2.5rem;
      border-radius: calc(var(--radius) / 2);
      background-color: var(--card-bg);
      color: var(--text-color);
      border: 1px solid var(--border-color);
      font-weight: 500;
      transition: var(--transition);
      cursor: pointer;
    }

    .page-link:hover {
      background-color: var(--primary-color);
      color: white;
      border-color: var(--primary-color);
    }

    .page-item.active .page-link {
      background-color: var(--primary-color);
      color: white;
      border-color: var(--primary-color);
    }

    .page-item.disabled .page-link {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .page-info {
      text-align: center;
      margin-top: 1rem;
      color: var(--text-secondary);
      font-size: 0.875rem;
    }

    /* Modal Styles - Perbaikan untuk responsivitas */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      z-index: 2000;
      padding: 1rem;
      overflow: auto;
    }

    .modal.active {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background-color: var(--card-bg);
      border-radius: var(--radius);
      width: 100%;
      max-width: 90vw; /* Mengurangi ukuran maksimal */
      max-height: 90vh; /* Mengurangi ukuran maksimal */
      overflow: hidden;
      box-shadow: var(--shadow-xl);
      display: flex;
      flex-direction: column;
    }

    .modal-header {
      padding: 1rem;
      border-bottom: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-shrink: 0;
    }

    .modal-title {
      font-weight: 600;
      font-size: 1.25rem;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 70%;
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 1.5rem;
      color: var(--text-secondary);
      cursor: pointer;
      transition: var(--transition);
      width: 2.5rem;
      height: 2.5rem;
      border-radius: calc(var(--radius) / 2);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .modal-close:hover {
      background-color: rgba(239, 68, 68, 0.1);
      color: var(--danger-color);
    }

    .modal-body {
      padding: 1rem;
      overflow-y: auto;
      flex: 1;
      max-height: calc(90vh - 120px); /* Mengurangi tinggi maksimal */
    }

    .file-details {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .detail-item {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }

    .detail-label {
      font-weight: 600;
      font-size: 0.875rem;
      color: var(--text-secondary);
    }

    .detail-value {
      font-weight: 500;
      color: var(--text-color);
      word-break: break-all;
    }

    .file-preview-container {
      margin-top: 1rem;
      display: flex;
      justify-content: center;
      align-items: center;
      max-height: calc(90vh - 250px); /* Mengatur tinggi maksimal preview */
      overflow: auto;
      padding: 1rem; /* Menambahkan padding */
    }

    .file-preview-image {
      max-width: 100%;
      max-height: 100%;
      border-radius: var(--radius);
      box-shadow: var(--shadow-md);
      object-fit: contain; /* Mengubah dari cover ke contain */
    }

    .file-preview-text {
      width: 100%;
      max-height: 100%;
      overflow-y: auto;
      background-color: var(--dark-bg);
      color: var(--text-color);
      padding: 1rem;
      border-radius: var(--radius);
      font-family: monospace;
      white-space: pre-wrap;
      font-size: 0.875rem; /* Mengurangi ukuran font */
    }

    .modal-footer {
      padding: 1rem;
      border-top: 1px solid var(--border-color);
      display: flex;
      justify-content: flex-end;
      flex-shrink: 0;
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border-radius: calc(var(--radius) / 2);
      border: none;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn-primary {
      background-color: var(--primary-color);
      color: white;
    }

    .btn-primary:hover {
      background-color: var(--secondary-color);
    }

    /* Slider Modal - Perbaikan responsivitas */
    .slider-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.9);
      z-index: 2000;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 2rem; /* Menambah padding untuk ruang lebih */
      overflow: auto;
    }

    .slider-modal.active {
      display: flex;
    }

    .slider-content {
      position: relative;
      max-width: calc(100vw - 4rem); /* Mengurangi ukuran maksimal dengan memperhitungkan padding */
      max-height: calc(100vh - 4rem); /* Mengurangi ukuran maksimal dengan memperhitungkan padding */
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem; /* Menambah padding internal */
    }

    .slider-image,
    .slider-video {
      max-width: 100%;
      max-height: calc(100vh - 8rem); /* Mengurangi tinggi maksimal untuk memberi ruang */
      border-radius: var(--radius);
      box-shadow: var(--shadow-xl);
      object-fit: contain; /* Mengubah dari cover ke contain */
    }

    .slider-close {
      position: fixed;
      top: 2rem; /* Menambah jarak dari atas */
      right: 2rem; /* Menambah jarak dari kanan */
      background: rgba(0, 0, 0, 0.7);
      color: white;
      border: none;
      width: 3rem;
      height: 3rem;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
    }

    .slider-close:hover {
      background-color: rgba(239, 68, 68, 0.8);
    }

    .slider-nav {
      position: fixed;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0, 0, 0, 0.7);
      color: white;
      border: none;
      width: 3rem;
      height: 3rem;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
    }

    .slider-nav:hover {
      background-color: rgba(37, 99, 235, 0.8);
    }

    .slider-prev {
      left: 2rem; /* Menambah jarak dari kiri */
    }

    .slider-next {
      right: 2rem; /* Menambah jarak dari kanan */
    }

    .slider-play {
      position: fixed;
      bottom: 3rem; /* Menambah jarak dari bawah */
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.7);
      color: white;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: calc(var(--radius) / 2);
      font-size: 1rem;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 0.5rem;
      z-index: 10;
    }

    .slider-play:hover {
      background-color: rgba(37, 99, 235, 0.8);
    }

    /* Back to Top Button */
    .back-to-top {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      background-color: var(--primary-color);
      color: white;
      border: none;
      width: 3rem;
      height: 3rem;
      border-radius: 50%;
      font-size: 1.25rem;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: var(--shadow-lg);
      z-index: 1000;
      display: none;
      align-items: center;
      justify-content: center;
    }

    .back-to-top:hover {
      background-color: var(--secondary-color);
      transform: translateY(-5px);
    }

    .back-to-top.visible {
      display: flex;
    }

    /* Loading Spinner */
    .loading-spinner {
      display: none;
      width: 3rem;
      height: 3rem;
      border: 0.25rem solid rgba(37, 99, 235, 0.2);
      border-top: 0.25rem solid var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 2rem auto;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 3rem 1rem;
      color: var(--text-secondary);
    }

    .empty-state i {
      font-size: 4rem;
      margin-bottom: 1rem;
      color: var(--text-light);
    }

    .empty-state h3 {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
      color: var(--text-color);
    }

    .empty-state p {
      font-size: 1rem;
      max-width: 500px;
      margin: 0 auto;
    }

    /* Responsive Design */
    @media (max-width: 992px) {
      .navbar-controls {
        flex-wrap: wrap;
        justify-content: flex-end;
      }
      
      .form-control, .form-select {
        width: 100px;
        font-size: 0.8rem;
        padding: 0.4rem 0.6rem;
      }
    }

    @media (max-width: 768px) {
      .navbar-container {
        flex-direction: column;
        height: auto;
        padding: 1rem;
      }
      
      .navbar-brand {
        margin-bottom: 1rem;
      }
      
      .navbar-controls {
        width: 100%;
        justify-content: center;
      }
      
      .form-control, .form-select {
        width: 80px;
        font-size: 0.75rem;
        padding: 0.3rem 0.5rem;
      }
      
      body {
        padding-top: 120px; /* Tinggi navbar di mobile */
      }

      .filter-controls {
        grid-template-columns: 1fr;
      }

      .stats-container {
        grid-template-columns: repeat(2, 1fr);
      }

      .media-grid {
        grid-template-columns: 1fr;
      }

      .file-details {
        grid-template-columns: 1fr;
      }
      
      .modal-content {
        max-width: 95vw;
        max-height: 95vh;
      }
      
      .modal-body {
        max-height: calc(95vh - 120px);
      }
      
      .file-preview-container {
        max-height: calc(95vh - 250px);
      }
      
      .slider-modal {
        padding: 1rem;
      }
      
      .slider-content {
        max-width: calc(100vw - 2rem);
        max-height: calc(100vh - 2rem);
      }
      
      .slider-image,
      .slider-video {
        max-height: calc(100vh - 6rem);
      }
      
      .slider-close {
        top: 1rem;
        right: 1rem;
      }
      
      .slider-prev {
        left: 1rem;
      }
      
      .slider-next {
        right: 1rem;
      }
      
      .slider-play {
        bottom: 2rem;
      }
    }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="navbar-container">
      <a class="navbar-brand" href="#">
        <i class="fas fa-photo-video"></i>
        Galeri Media Premium
      </a>
      
      <div class="navbar-controls">
        <input type="file" id="folderInput" webkitdirectory multiple class="form-control" />
        <input type="text" id="searchInput" class="form-control" placeholder="🔍" />
        <select id="mediaFilter" class="form-select">
          <option value="all">Semua</option>
          <option value="image">Gambar</option>
          <option value="video">Video</option>
          <option value="document">Dokumen</option>
          <option value="audio">Audio</option>
          <option value="archive">Arsip</option>
          <option value="other">Lainnya</option>
        </select>
        <select id="extensionFilter" class="form-select">
          <option value="">Ekstensi</option>
        </select>
        <div class="theme-toggle" id="toggleTheme">
          <div class="theme-toggle-slider">
            <i class="fas fa-sun" id="themeIcon"></i>
          </div>
        </div>
      </div>
    </div>
  </nav>
  
  <div class="container-fluid">
    <div class="filter-section">
      <div class="filter-title">
        <i class="fas fa-filter"></i>
        Filter Berdasarkan Metadata
      </div>
      
      <div class="filter-controls">
        <div class="filter-group">
          <label for="sizeFilter">Ukuran File</label>
          <select id="sizeFilter" class="form-select">
            <option value="">Semua Ukuran</option>
            <option value="small">Kecil (&lt; 1MB)</option>
            <option value="medium">Sedang (1MB - 10MB)</option>
            <option value="large">Besar (&gt; 10MB)</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="dateFilter">Tanggal</label>
          <select id="dateFilter" class="form-select">
            <option value="">Semua Tanggal</option>
            <option value="today">Hari Ini</option>
            <option value="week">Minggu Ini</option>
            <option value="month">Bulan Ini</option>
            <option value="year">Tahun Ini</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="sortBy">Urutkan</label>
          <select id="sortBy" class="form-select">
            <option value="name">Nama</option>
            <option value="size">Ukuran</option>
            <option value="date">Tanggal</option>
            <option value="type">Tipe</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="sortOrder">Urutan</label>
          <select id="sortOrder" class="form-select">
            <option value="asc">Naik</option>
            <option value="desc">Turun</option>
          </select>
        </div>
      </div>
      
      <button id="clearFilters" class="btn btn-primary mt-3">
        <i class="fas fa-times"></i>
        Hapus Semua Filter
      </button>
    </div>
    
    <div class="stats-container">
      <div class="stat-card">
        <i class="fas fa-files stat-icon"></i>
        <div class="stat-value" id="totalFiles">0</div>
        <div class="stat-label">Total File</div>
      </div>
      <div class="stat-card">
        <i class="fas fa-image stat-icon"></i>
        <div class="stat-value" id="totalImages">0</div>
        <div class="stat-label">Gambar</div>
      </div>
      <div class="stat-card">
        <i class="fas fa-video stat-icon"></i>
        <div class="stat-value" id="totalVideos">0</div>
        <div class="stat-label">Video</div>
      </div>
      <div class="stat-card">
        <i class="fas fa-file stat-icon"></i>
        <div class="stat-value" id="totalDocuments">0</div>
        <div class="stat-label">Dokumen</div>
      </div>
      <div class="stat-card">
        <i class="fas fa-database stat-icon"></i>
        <div class="stat-value" id="totalSize">0 MB</div>
        <div class="stat-label">Total Ukuran</div>
      </div>
    </div>

    <h2 class="section-title">
      <i class="fas fa-folder-open"></i>
      File Anda
    </h2>
    
    <div class="loading-spinner" id="loadingSpinner"></div>
    
    <div id="mediaList" class="media-grid"></div>
    
    <div class="pagination-container">
      <nav aria-label="Navigasi halaman">
        <ul class="pagination" id="paginationControls"></ul>
      </nav>
    </div>
    
    <div class="page-info" id="pageInfo"></div>
  </div>
  
  <!-- Modal untuk gambar/video -->
  <div id="sliderModal" class="slider-modal">
    <div class="slider-content">
      <button class="slider-close" id="sliderClose">
        <i class="fas fa-times"></i>
      </button>
      <video id="sliderVideo" controls style="display:none;"></video>
      <img id="sliderImage" src="" alt="Slider Image" style="display:none;">
      <button id="playBtn" class="slider-play" style="display:none;">
        <i class="fas fa-play"></i>
        Putar
      </button>
      <button class="slider-nav slider-prev" id="sliderPrev">
        <i class="fas fa-chevron-left"></i>
      </button>
      <button class="slider-nav slider-next" id="sliderNext">
        <i class="fas fa-chevron-right"></i>
      </button>
    </div>
  </div>
  
  <!-- Modal untuk file non-media -->
  <div id="fileModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Detail File</h3>
        <button class="modal-close" id="fileModalClose">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
        <div class="file-details">
          <div class="detail-item">
            <div class="detail-label">Nama File</div>
            <div class="detail-value" id="fileModalName"></div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Ukuran</div>
            <div class="detail-value" id="fileModalSize"></div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Tipe</div>
            <div class="detail-value" id="fileModalType"></div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Dimodifikasi</div>
            <div class="detail-value" id="fileModalModified"></div>
          </div>
          <div class="detail-item">
            <div class="detail-label">Path</div>
            <div class="detail-value" id="fileModalPath"></div>
          </div>
        </div>
        <div class="file-preview-container" id="filePreviewContainer">
          <!-- Preview akan ditambahkan secara dinamis -->
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" id="fileDownloadBtn">
          <i class="fas fa-download"></i>
          Unduh File
        </button>
      </div>
    </div>
  </div>

  <button class="back-to-top" id="backToTop">
    <i class="fas fa-arrow-up"></i>
  </button>

  <script>
    let currentPage = 1;
    const itemsPerPage = 12;
    let filteredFiles = [];
    let currentIndex = 0;
    let images = [], videos = [], allFiles = [];
    let uniqueExtensions = new Set();
    let fileMetadata = [];

    // Kategori file
    const imageExtensions = ['.jpg', '.jpeg', '.png', '.gif', '.bmp', '.webp', '.svg', '.ico'];
    const videoExtensions = ['.ts', '.mov', '.mkv', '.mp4', '.webm', '.ogg', '.avi', '.flv', '.wmv'];
    const documentExtensions = ['.pdf', '.doc', '.docx', '.xls', '.xlsx', '.ppt', '.pptx', '.txt', '.md', '.rtf'];
    const audioExtensions = ['.mp3', '.wav', '.flac', '.aac', '.ogg', '.wma', '.m4a'];
    const archiveExtensions = ['.zip', '.rar', '.7z', '.tar', '.gz', '.bz2'];
    const textExtensions = ['.txt', '.md', '.json', '.xml', '.csv', '.html', '.htm', '.css', '.js', '.sql', '.py', '.java', '.c', '.cpp', '.h'];

    // Fungsi untuk menentukan kategori file
    function getFileCategory(file) {
      const ext = '.' + file.name.split('.').pop().toLowerCase();
      
      if (imageExtensions.includes(ext)) return 'image';
      if (videoExtensions.includes(ext)) return 'video';
      if (documentExtensions.includes(ext)) return 'document';
      if (audioExtensions.includes(ext)) return 'audio';
      if (archiveExtensions.includes(ext)) return 'archive';
      
      return 'other';
    }

    // Fungsi untuk menentukan apakah file adalah gambar
    function isImage(file) {
      return getFileCategory(file) === 'image';
    }

    // Fungsi untuk menentukan apakah file adalah video
    function isVideo(file) {
      return getFileCategory(file) === 'video';
    }

    // Fungsi untuk menentukan apakah file adalah dokumen
    function isDocument(file) {
      return getFileCategory(file) === 'document';
    }

    // Fungsi untuk menentukan apakah file adalah audio
    function isAudio(file) {
      return getFileCategory(file) === 'audio';
    }

    // Fungsi untuk menentukan apakah file adalah arsip
    function isArchive(file) {
      return getFileCategory(file) === 'archive';
    }

    // Fungsi untuk menentukan apakah file adalah teks
    function isText(file) {
      const ext = '.' + file.name.split('.').pop().toLowerCase();
      return textExtensions.includes(ext);
    }

    // Fungsi untuk format ukuran file
    function formatFileSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    // Fungsi untuk mendapatkan ikon file berdasarkan ekstensi
    function getFileIcon(extension) {
      const ext = extension.toLowerCase();
      
      if (imageExtensions.includes('.' + ext)) return 'fa-image';
      if (videoExtensions.includes('.' + ext)) return 'fa-video';
      if (documentExtensions.includes('.' + ext)) {
        if (ext === 'pdf') return 'fa-file-pdf';
        if (['doc', 'docx'].includes(ext)) return 'fa-file-word';
        if (['xls', 'xlsx'].includes(ext)) return 'fa-file-excel';
        if (['ppt', 'pptx'].includes(ext)) return 'fa-file-powerpoint';
        return 'fa-file-alt';
      }
      if (audioExtensions.includes('.' + ext)) return 'fa-file-audio';
      if (archiveExtensions.includes('.' + ext)) return 'fa-file-archive';
      if (textExtensions.includes('.' + ext)) return 'fa-file-code';
      
      return 'fa-file';
    }

    // Fungsi untuk membaca file teks
    function readTextFile(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result);
        reader.onerror = reject;
        reader.readAsText(file);
      });
    }

    // Fungsi untuk membaca file sebagai data URL
    function readFileAsDataURL(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = () => resolve(reader.result);
        reader.onerror = reject;
        reader.readAsDataURL(file);
      });
    }

    // Fungsi untuk mendapatkan metadata file
    async function getFileMetadata(file) {
      return new Promise((resolve) => {
        const metadata = {
          name: file.name,
          size: file.size,
          sizeFormatted: formatFileSize(file.size),
          type: file.type || 'Unknown',
          lastModified: new Date(file.lastModified),
          extension: file.name.split('.').pop().toLowerCase(),
          path: file.webkitRelativePath || file.name,
          category: getFileCategory(file),
          isImage: isImage(file),
          isVideo: isVideo(file),
          isDocument: isDocument(file),
          isAudio: isAudio(file),
          isArchive: isArchive(file),
          isText: isText(file)
        };

        // Jika ini adalah gambar, dapatkan dimensinya
        if (metadata.isImage) {
          const img = new Image();
          img.onload = function() {
            metadata.width = this.width;
            metadata.height = this.height;
            metadata.dimensions = `${this.width}x${this.height}`;
            resolve(metadata);
          };
          img.onerror = function() {
            resolve(metadata);
          };
          img.src = URL.createObjectURL(file);
        } 
        // Jika ini adalah video, dapatkan durasinya
        else if (metadata.isVideo) {
          const video = document.createElement('video');
          video.onloadedmetadata = function() {
            metadata.duration = this.duration;
            metadata.width = this.videoWidth;
            metadata.height = this.videoHeight;
            metadata.dimensions = `${this.videoWidth}x${this.videoHeight}`;
            resolve(metadata);
          };
          video.onerror = function() {
            resolve(metadata);
          };
          video.src = URL.createObjectURL(file);
        } 
        else {
          resolve(metadata);
        }
      });
    }

    // Fungsi untuk memproses semua file dan mendapatkan metadata
    async function processFiles(files) {
      document.getElementById('loadingSpinner').style.display = 'block';
      
      const mediaFiles = Array.from(files);
      
      if (mediaFiles.length === 0) {
        alert("📂 Folder tidak berisi file.");
        document.getElementById('loadingSpinner').style.display = 'none';
        return;
      }

      // Reset sets
      uniqueExtensions = new Set();
      
      // Proses semua file untuk mendapatkan metadata
      const metadataPromises = mediaFiles.map(file => getFileMetadata(file));
      fileMetadata = await Promise.all(metadataPromises);
      
      // Simpan file asli untuk digunakan nanti
      allFiles = mediaFiles;
      
      // Kumpulkan semua ekstensi unik dari file
      allFiles.forEach(file => {
        const ext = file.name.split('.').pop().toLowerCase();
        uniqueExtensions.add(ext);
      });
      
      // Update filter ekstensi
      updateExtensionFilter();
      
      // Update statistik
      updateStatistics();
      
      // Filter dan render media
      filterAndRenderMedia();
      
      document.getElementById('loadingSpinner').style.display = 'none';
    }

    document.getElementById("folderInput").addEventListener("change", function(event) {
      const files = event.target.files;
      processFiles(files);
    });

    document.getElementById("searchInput").addEventListener("input", () => filterAndRenderMedia());
    document.getElementById("mediaFilter").addEventListener("change", () => filterAndRenderMedia());
    document.getElementById("extensionFilter").addEventListener("change", () => filterAndRenderMedia());
    document.getElementById("sizeFilter").addEventListener("change", () => filterAndRenderMedia());
    document.getElementById("dateFilter").addEventListener("change", () => filterAndRenderMedia());
    document.getElementById("sortBy").addEventListener("change", () => filterAndRenderMedia());
    document.getElementById("sortOrder").addEventListener("change", () => filterAndRenderMedia());
    
    document.getElementById("clearFilters").addEventListener("click", function() {
      document.getElementById("searchInput").value = "";
      document.getElementById("mediaFilter").value = "all";
      document.getElementById("extensionFilter").value = "";
      document.getElementById("sizeFilter").value = "";
      document.getElementById("dateFilter").value = "";
      document.getElementById("sortBy").value = "name";
      document.getElementById("sortOrder").value = "asc";
      
      filterAndRenderMedia();
    });

    function updateExtensionFilter() {
      const extensionFilter = document.getElementById("extensionFilter");
      // Simpan nilai yang dipilih sekarang
      const currentValue = extensionFilter.value;
      
      // Kosongkan dropdown kecuali opsi default
      extensionFilter.innerHTML = '<option value="">Ekstensi</option>';
      
      // Urutkan ekstensi secara alfabetis
      const sortedExtensions = Array.from(uniqueExtensions).sort();
      
      // Tambahkan setiap ekstensi ke dropdown
      sortedExtensions.forEach(ext => {
        const option = document.createElement("option");
        option.value = ext;
        option.textContent = ext.toUpperCase();
        extensionFilter.appendChild(option);
      });
      
      // Kembalikan nilai yang dipilih sebelumnya jika masih ada
      if (sortedExtensions.includes(currentValue)) {
        extensionFilter.value = currentValue;
      }
    }

    function updateStatistics() {
      const totalFiles = fileMetadata.length;
      const totalImages = fileMetadata.filter(f => f.isImage).length;
      const totalVideos = fileMetadata.filter(f => f.isVideo).length;
      const totalDocuments = fileMetadata.filter(f => f.isDocument).length;
      const totalSize = fileMetadata.reduce((sum, f) => sum + f.size, 0);
      
      document.getElementById('totalFiles').textContent = totalFiles;
      document.getElementById('totalImages').textContent = totalImages;
      document.getElementById('totalVideos').textContent = totalVideos;
      document.getElementById('totalDocuments').textContent = totalDocuments;
      document.getElementById('totalSize').textContent = formatFileSize(totalSize);
    }

    function filterAndRenderMedia() {
      const keyword = document.getElementById("searchInput").value.toLowerCase();
      const filter = document.getElementById("mediaFilter").value;
      const extensionFilter = document.getElementById("extensionFilter").value;
      const sizeFilter = document.getElementById("sizeFilter").value;
      const dateFilter = document.getElementById("dateFilter").value;
      const sortBy = document.getElementById("sortBy").value;
      const sortOrder = document.getElementById("sortOrder").value;

      images = [];
      videos = [];

      filteredFiles = fileMetadata.filter((metadata, index) => {
        const file = allFiles[index];
        
        // Filter berdasarkan nama file
        const nameMatch = metadata.name.toLowerCase().includes(keyword);
        
        // Filter berdasarkan kategori
        const categoryMatch = filter === "all" || metadata.category === filter;
        
        // Filter berdasarkan ekstensi
        const extensionMatch = !extensionFilter || metadata.extension === extensionFilter;
        
        // Filter berdasarkan ukuran
        let sizeMatch = true;
        if (sizeFilter) {
          switch (sizeFilter) {
            case "small":
              sizeMatch = metadata.size < 1024 * 1024; // Kurang dari 1MB
              break;
            case "medium":
              sizeMatch = metadata.size >= 1024 * 1024 && metadata.size <= 10 * 1024 * 1024; // 1MB - 10MB
              break;
            case "large":
              sizeMatch = metadata.size > 10 * 1024 * 1024; // Lebih dari 10MB
              break;
          }
        }
        
        // Filter berdasarkan tanggal
        let dateMatch = true;
        if (dateFilter) {
          const fileDate = new Date(metadata.lastModified);
          const today = new Date();
          
          switch (dateFilter) {
            case "today":
              dateMatch = fileDate.toDateString() === today.toDateString();
              break;
            case "week":
              const weekAgo = new Date(today);
              weekAgo.setDate(today.getDate() - 7);
              dateMatch = fileDate >= weekAgo;
              break;
            case "month":
              dateMatch = fileDate.getMonth() === today.getMonth() && 
                         fileDate.getFullYear() === today.getFullYear();
              break;
            case "year":
              dateMatch = fileDate.getFullYear() === today.getFullYear();
              break;
          }
        }
        
        return nameMatch && categoryMatch && extensionMatch && sizeMatch && dateMatch;
      });

      // Sortir hasil
      filteredFiles.sort((a, b) => {
        let aValue, bValue;
        
        switch (sortBy) {
          case "name":
            aValue = a.name.toLowerCase();
            bValue = b.name.toLowerCase();
            break;
          case "size":
            aValue = a.size;
            bValue = b.size;
            break;
          case "date":
            aValue = a.lastModified;
            bValue = b.lastModified;
            break;
          case "type":
            aValue = a.extension;
            bValue = b.extension;
            break;
          default:
            aValue = a.name.toLowerCase();
            bValue = b.name.toLowerCase();
        }
        
        if (sortOrder === "asc") {
          return aValue > bValue ? 1 : -1;
        } else {
          return aValue < bValue ? 1 : -1;
        }
      });

      renderPage(currentPage = 1);
      renderPagination();
    }

    function renderPage(page) {
      currentPage = page;
      const mediaContainer = document.getElementById("mediaList");
      mediaContainer.innerHTML = "";

      if (filteredFiles.length === 0) {
        const emptyState = document.createElement("div");
        emptyState.className = "empty-state";
        emptyState.innerHTML = `
          <i class="fas fa-folder-open"></i>
          <h3>Tidak ada file yang ditemukan</h3>
          <p>Coba ubah filter atau pilih folder lain.</p>
        `;
        mediaContainer.appendChild(emptyState);
        return;
      }

      const start = (page - 1) * itemsPerPage;
      const end = start + itemsPerPage;
      const pageItems = filteredFiles.slice(start, end);

      pageItems.forEach((metadata, index) => {
        const fileIndex = fileMetadata.indexOf(metadata);
        const file = allFiles[fileIndex];
        
        const card = document.createElement("div");
        card.className = "media-card";

        const ext = metadata.extension;
        const badge = document.createElement("div");
        badge.className = "file-ext ext-" + ext;
        badge.textContent = ext;
        card.appendChild(badge);

        if (metadata.isImage) {
          const preview = document.createElement("div");
          preview.className = "media-preview";
          
          const img = document.createElement("img");
          img.src = URL.createObjectURL(file);
          img.loading = "lazy";
          images.push(img.src);
          img.addEventListener("click", () => openSliderImage(images.indexOf(img.src)));
          preview.appendChild(img);
          
          card.appendChild(preview);
        } else if (metadata.isVideo) {
          const preview = document.createElement("div");
          preview.className = "media-preview";
          
          const vid = document.createElement("video");
          vid.src = URL.createObjectURL(file);
          videos.push(vid.src);
          vid.addEventListener("click", () => openSliderVideo(videos.indexOf(vid.src)));
          preview.appendChild(vid);
          
          card.appendChild(preview);
        } else {
          // Untuk file non-media, tampilkan preview
          const preview = document.createElement("div");
          preview.className = "file-preview";
          
          const icon = document.createElement("i");
          icon.className = "fas " + getFileIcon(ext) + " file-icon";
          preview.appendChild(icon);
          
          // Tambahkan informasi file
          const fileInfo = document.createElement("div");
          fileInfo.className = "file-info";
          fileInfo.textContent = metadata.sizeFormatted;
          preview.appendChild(fileInfo);
          
          // Tambahkan overlay nama file
          const nameOverlay = document.createElement("div");
          nameOverlay.className = "file-name-overlay";
          nameOverlay.textContent = metadata.name;
          preview.appendChild(nameOverlay);
          
          // Tambahkan event listener untuk membuka modal saat diklik
          preview.addEventListener("click", () => openFileModal(file, metadata));
          
          card.appendChild(preview);
        }

        const details = document.createElement("div");
        details.className = "media-details";

        const name = document.createElement("div");
        name.className = "media-title";
        name.textContent = metadata.name;

        const meta = document.createElement("div");
        meta.className = "media-meta";
        meta.innerHTML = `
          <span>${metadata.sizeFormatted}</span>
          <span>${new Date(metadata.lastModified).toLocaleDateString()}</span>
        `;

        const path = document.createElement("div");
        path.className = "media-path";
        path.textContent = metadata.path;

        const actions = document.createElement("div");
        actions.className = "media-actions";
        
        const viewBtn = document.createElement("button");
        viewBtn.className = "btn-action btn-view";
        viewBtn.innerHTML = `<i class="fas fa-eye"></i> Lihat`;
        viewBtn.addEventListener("click", () => {
          if (metadata.isImage) {
            openSliderImage(images.indexOf(URL.createObjectURL(file)));
          } else if (metadata.isVideo) {
            openSliderVideo(videos.indexOf(URL.createObjectURL(file)));
          } else {
            openFileModal(file, metadata);
          }
        });
        
        const copyBtn = document.createElement("button");
        copyBtn.className = "btn-action btn-copy";
        copyBtn.innerHTML = `<i class="fas fa-copy"></i> Salin`;
        copyBtn.addEventListener("click", () => {
          navigator.clipboard.writeText(metadata.path).then(() => {
            copyBtn.innerHTML = `<i class="fas fa-check"></i> Tersalin`;
            setTimeout(() => {
              copyBtn.innerHTML = `<i class="fas fa-copy"></i> Salin`;
            }, 1500);
          });
        });
        
        actions.appendChild(viewBtn);
        actions.appendChild(copyBtn);

        details.appendChild(name);
        details.appendChild(meta);
        details.appendChild(path);
        details.appendChild(actions);
        
        card.appendChild(details);
        mediaContainer.appendChild(card);
      });
    }

    function renderPagination() {
      const pagination = document.getElementById("paginationControls");
      pagination.innerHTML = "";

      const totalPages = Math.ceil(filteredFiles.length / itemsPerPage);
      if (totalPages <= 1) return;

      const prevLi = document.createElement("li");
      prevLi.className = `page-item ${currentPage === 1 ? "disabled" : ""}`;
      const prevBtn = document.createElement("button");
      prevBtn.className = "page-link";
      prevBtn.innerHTML = `<i class="fas fa-chevron-left"></i>`;
      prevBtn.onclick = () => {
        if (currentPage > 1) {
          renderPage(currentPage - 1);
          renderPagination();
        }
      };
      prevLi.appendChild(prevBtn);
      pagination.appendChild(prevLi);

      const maxButtons = 5;
      let startPage = Math.max(1, currentPage - Math.floor(maxButtons / 2));
      let endPage = startPage + maxButtons - 1;

      if (endPage > totalPages) {
        endPage = totalPages;
        startPage = Math.max(1, endPage - maxButtons + 1);
      }

      for (let i = startPage; i <= endPage; i++) {
        const li = document.createElement("li");
        li.className = `page-item ${i === currentPage ? "active" : ""}`;
        const btn = document.createElement("button");
        btn.className = "page-link";
        btn.textContent = i;
        btn.onclick = () => {
          renderPage(i);
          renderPagination();
        };
        li.appendChild(btn);
        pagination.appendChild(li);
      }

      const nextLi = document.createElement("li");
      nextLi.className = `page-item ${currentPage === totalPages ? "disabled" : ""}`;
      const nextBtn = document.createElement("button");
      nextBtn.className = "page-link";
      nextBtn.innerHTML = `<i class="fas fa-chevron-right"></i>`;
      nextBtn.onclick = () => {
        if (currentPage < totalPages) {
          renderPage(currentPage + 1);
          renderPagination();
        }
      };
      nextLi.appendChild(nextBtn);
      pagination.appendChild(nextLi);

      // Tambahkan info halaman di bawah pagination
      document.getElementById("pageInfo").textContent = `Menampilkan ${((currentPage - 1) * itemsPerPage) + 1}-${Math.min(currentPage * itemsPerPage, filteredFiles.length)} dari ${filteredFiles.length} file`;
    }

    function openSliderImage(index) {
      currentIndex = index;
      document.getElementById("sliderModal").classList.add("active");
      document.getElementById("sliderImage").src = images[currentIndex];
      document.getElementById("sliderImage").style.display = "block";
      document.getElementById("sliderVideo").style.display = "none";
      document.getElementById("playBtn").style.display = "none";
    }

    function openSliderVideo(index) {
      currentIndex = index;
      const vid = document.getElementById("sliderVideo");
      document.getElementById("sliderModal").classList.add("active");
      vid.src = videos[currentIndex];
      vid.style.display = "block";
      document.getElementById("sliderImage").style.display = "none";
      document.getElementById("playBtn").style.display = "block";
    }

    // Fungsi untuk membuka modal file non-media
    async function openFileModal(file, metadata) {
      // Set informasi file
      document.getElementById("fileModalName").textContent = metadata.name;
      document.getElementById("fileModalSize").textContent = metadata.sizeFormatted;
      document.getElementById("fileModalType").textContent = metadata.type;
      document.getElementById("fileModalModified").textContent = new Date(metadata.lastModified).toLocaleString();
      document.getElementById("fileModalPath").textContent = metadata.path;
      
      // Set tombol unduh
      const downloadBtn = document.getElementById("fileDownloadBtn");
      downloadBtn.onclick = () => {
        const url = URL.createObjectURL(file);
        const a = document.createElement('a');
        a.href = url;
        a.download = file.name;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
      };
      
      // Kosongkan container preview
      const previewContainer = document.getElementById("filePreviewContainer");
      previewContainer.innerHTML = '';
      
      // Tampilkan preview berdasarkan jenis file
      if (metadata.isImage) {
        // Untuk gambar, tampilkan preview gambar
        const img = document.createElement('img');
        img.className = 'file-preview-image';
        img.src = URL.createObjectURL(file);
        previewContainer.appendChild(img);
      } else if (metadata.isText) {
        // Untuk file teks, baca dan tampilkan kontennya
        try {
          const text = await readTextFile(file);
          const textContainer = document.createElement('div');
          textContainer.className = 'file-preview-text';
          textContainer.textContent = text;
          previewContainer.appendChild(textContainer);
        } catch (error) {
          const errorDiv = document.createElement('div');
          errorDiv.textContent = 'Tidak dapat membaca file: ' + error.message;
          previewContainer.appendChild(errorDiv);
        }
      } else {
        // Untuk file lain, tampilkan informasi bahwa preview tidak tersedia
        const noPreview = document.createElement('div');
        noPreview.textContent = 'Preview tidak tersedia untuk jenis file ini. Silakan unduh file untuk melihat kontennya.';
        previewContainer.appendChild(noPreview);
      }
      
      // Tampilkan modal
      document.getElementById("fileModal").classList.add("active");
    }

    document.getElementById("sliderClose").addEventListener("click", () => {
      document.getElementById("sliderModal").classList.remove("active");
      const vid = document.getElementById("sliderVideo");
      vid.pause();
      vid.src = "";
      document.getElementById("sliderImage").src = "";
    });

    document.getElementById("fileModalClose").addEventListener("click", () => {
      document.getElementById("fileModal").classList.remove("active");
    });

    document.getElementById("sliderPrev").addEventListener("click", () => {
      if (document.getElementById("sliderImage").style.display === "block") {
        currentIndex = (currentIndex - 1 + images.length) % images.length;
        document.getElementById("sliderImage").src = images[currentIndex];
      } else {
        currentIndex = (currentIndex - 1 + videos.length) % videos.length;
        document.getElementById("sliderVideo").src = videos[currentIndex];
        document.getElementById("sliderVideo").play();
      }
    });

    document.getElementById("sliderNext").addEventListener("click", () => {
      if (document.getElementById("sliderImage").style.display === "block") {
        currentIndex = (currentIndex + 1) % images.length;
        document.getElementById("sliderImage").src = images[currentIndex];
      } else {
        currentIndex = (currentIndex + 1) % videos.length;
        document.getElementById("sliderVideo").src = videos[currentIndex];
        document.getElementById("sliderVideo").play();
      }
    });

    document.getElementById("playBtn").addEventListener("click", function () {
      const vid = document.getElementById("sliderVideo");
      vid.play();
      this.style.display = "none";
    });

    window.onscroll = () => {
      const backToTop = document.getElementById("backToTop");
      if (window.scrollY > 200) {
        backToTop.classList.add("visible");
      } else {
        backToTop.classList.remove("visible");
      }
    };

    document.getElementById("backToTop").addEventListener("click", () => {
      window.scrollTo({ top: 0, behavior: "smooth" });
    });

    document.addEventListener("keydown", function (e) {
      const sliderModal = document.getElementById("sliderModal");
      const fileModal = document.getElementById("fileModal");
      
      if (sliderModal.classList.contains("active")) {
        if (e.key === "ArrowRight") document.getElementById("sliderNext").click();
        else if (e.key === "ArrowLeft") document.getElementById("sliderPrev").click();
        else if (e.key === "Escape") document.getElementById("sliderClose").click();
      } else if (fileModal.classList.contains("active")) {
        if (e.key === "Escape") document.getElementById("fileModalClose").click();
      }
    });

    document.getElementById("toggleTheme").addEventListener("click", () => {
      document.body.classList.toggle("dark");
      const isDark = document.body.classList.contains("dark");
      const themeIcon = document.getElementById("themeIcon");
      
      if (isDark) {
        themeIcon.className = "fas fa-moon";
      } else {
        themeIcon.className = "fas fa-sun";
      }
    });

    // Menutup modal saat klik di luar konten
    document.getElementById("sliderModal").addEventListener("click", function (e) {
      if (e.target === this) {
        document.getElementById("sliderClose").click();
      }
    });

    document.getElementById("fileModal").addEventListener("click", function (e) {
      if (e.target === this) {
        document.getElementById("fileModalClose").click();
      }
    });

    // Inisialisasi tema
    document.addEventListener("DOMContentLoaded", function() {
      // Cek preferensi tema yang tersimpan
      const savedTheme = localStorage.getItem("theme");
      if (savedTheme === "dark") {
        document.body.classList.add("dark");
        document.getElementById("themeIcon").className = "fas fa-moon";
      }
      
      // Simpan preferensi tema saat berubah
      document.getElementById("toggleTheme").addEventListener("click", function() {
        const isDark = document.body.classList.contains("dark");
        localStorage.setItem("theme", isDark ? "dark" : "light");
      });
    });
  </script>
</body>
</html>
